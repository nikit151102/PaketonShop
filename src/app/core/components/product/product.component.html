<div class="product-card" [ngClass]="view" [routerLink]="['/product', product.id] ">
    <div class="top-bar">
        <div class="badge" [ngClass]="product.badgeType">{{ product.badge }}</div>
        <div class="actions">
            <span (click)="toggleFavorite()" [class.active]="product.favorite">‚ù§</span>
            <span *ngIf="showCompare" (click)="toggleCompare()" [class.active]="product.compare">‚áÑ</span>
        </div>
    </div>

    <div class="image-wrapper">
        <img [src]="(product.productImageLinks[0] || 'assets/images/no-image.png') | cleanStringLink"
            alt="{{ product.fullName }}" />

        <!-- üîπ –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä -->
        <button class="quick-view" *ngIf="hovered" (click)="openQuickView()">üëÅ –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</button>
    </div>

    <div class="content">
        <h4>{{ product.fullName }}</h4>
        <span id="article">–∞—Ä—Ç–∏–∫—É–ª: {{product.article}}</span>
        <!-- üîπ –Ω–∞–ª–∏—á–∏–µ –∏ —É–ø–∞–∫–æ–≤–∫–∞ -->
        <div class="extra-info">
            <span class="stock" *ngIf="product.remains.length > 0">–í –Ω–∞–ª–∏—á–∏–∏: {{ product.remains[0].quantity }}
                —É–ø–∞–∫.</span>
            <span class="pack" *ngIf="product.packCount">–í —É–ø–∞–∫–æ–≤–∫–µ: {{ product.packCount }} —à—Ç.</span>
        </div>

        <div class="price-block">
            <span class="main-price">
                {{ getPrice(city$ | async) }} ‚ÇΩ
            </span>
            <span *ngIf="product.oldPrice" class="old-price">{{ product.oldPrice }} ‚ÇΩ</span>
            <span *ngIf="product.oldPrice" class="discount">
                -{{ ((1 - (getPrice(city$ | async)) / product.oldPrice) * 100) | number:'1.0-0' }}%
            </span>
        </div>



        <button class="add-cart" *ngIf="!inCart" (click)="addToCart($event)">üõí –í –∫–æ—Ä–∑–∏–Ω—É</button>
    </div>
</div>

<div class="quick-view-modal" *ngIf="showQuickView">
    <div class="modal-content">
        <button class="close" (click)="closeQuickView()">‚úñ</button>
        <!-- <img [src]="product.imageInstances[0]?.url" alt="{{ product.fullName }}" />
        <h3>{{ product.fullName }}</h3>
        <p>–¶–µ–Ω–∞: {{ product.retailPrice }} ‚ÇΩ</p>
        <p *ngIf="product.oldPrice">–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞: {{ product.oldPrice }} ‚ÇΩ</p>
        <p>–í –Ω–∞–ª–∏—á–∏–∏: {{ product.remains[0]?.quantity }} —É–ø–∞–∫., –≤ —É–ø–∞–∫–æ–≤–∫–µ: {{ product.packCount }} —à—Ç.</p>
        <p>–†–µ–π—Ç–∏–Ω–≥: {{ product.rating }} ‚≠ê ({{ product.reviews }} –æ—Ç–∑—ã–≤–æ–≤)</p> -->
    </div>
    <div class="overlay" (click)="closeQuickView()"></div>
</div>