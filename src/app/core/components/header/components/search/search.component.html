<div class="search-bar">
  <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –∏ –¥—Ä–æ–ø–¥–∞—É–Ω–æ–≤ -->
  <div class="positioned-wrapper">
    <!-- –ò–∫–æ–Ω–∫–∞ –ø–æ–∏—Å–∫–∞ -->
    <i class="fas fa-search"></i>

    <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ -->
    <input #searchInput type="text" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." [(ngModel)]="searchQuery"
      (ngModelChange)="onSearch()" (keyup.enter)="performSearch()" (focus)="onInputFocus()" (blur)="onInputBlur()" />

    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div *ngIf="isLoading" class="loading-indicator">
      <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–∏—Å–∫–∞ -->
    <button class="search-btn" (click)="performSearch()" aria-label="–ù–∞–π—Ç–∏" [disabled]="isLoading">
      üîç
    </button>

    <!-- –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–∞ -->
    <div class="autocomplete-dropdown" *ngIf="autocompleteResults?.length">
      <div class="autocomplete-item" *ngFor="let item of autocompleteResults" (click)="selectItem(item)">
        <img [src]="item.image" alt="{{ item.name }}" />
        <div class="item-info">
          <span class="item-name">{{ item.name }}</span>
          <span class="item-sku">{{ item.sku }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- –ö–Ω–æ–ø–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞ -->
  <button class="filter-btn" (click)="toggleFilters()" aria-label="–§–∏–ª—å—Ç—Ä—ã">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
      <path
        d="M3 6h12a1 1 0 0 0 0-2H3a1 1 0 0 0 0 2zm0 7h18a1 1 0 0 0 0-2H3a1 1 0 0 0 0 2zm0 7h9a1 1 0 0 0 0-2H3a1 1 0 0 0 0 2z" />
      <circle cx="18" cy="5" r="2" />
      <circle cx="9" cy="12" r="2" />
      <circle cx="15" cy="19" r="2" />
    </svg>
  </button>
</div>

<!-- –ú–∞–ª–µ–Ω—å–∫–æ–µ –≤—ã–ø–∞–¥–∞—é—â–µ–µ –æ–∫–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
<div class="filters-dropdown" *ngIf="filtersOpen">
  <h4>–§–∏–ª—å—Ç—Ä—ã</h4>

  <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>

  <!-- –¶–µ–Ω–∞ -->
  <div class="filter-group">
    <label>–¶–µ–Ω–∞ (‚ÇΩ)</label>
    <div class="price-inputs">
      <input type="number" [(ngModel)]="filters.priceMin" placeholder="–æ—Ç" min="0" />
      <input type="number" [(ngModel)]="filters.priceMax" placeholder="–¥–æ" min="0" />
    </div>
  </div>

  <!-- –ù–∞–ª–∏—á–∏–µ -->
  <div class="filter-group">
    <label>
      <input type="checkbox" [(ngModel)]="filters.inStock" />
      –í –Ω–∞–ª–∏—á–∏–∏
    </label>
  </div>

  <!-- –î–æ–ø. —Ñ–∏–ª—å—Ç—Ä—ã -->
  <div class="filter-group">
    <label>
      <input type="checkbox" [(ngModel)]="filters.discountOnly" />
      –°–æ —Å–∫–∏–¥–∫–æ–π
    </label>
  </div>

  <div class="filter-actions">
    <button class="apply" (click)="applyFilters()" [disabled]="isLoading">
      {{ isLoading ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : '–ü—Ä–∏–º–µ–Ω–∏—Ç—å' }}
    </button>
    <button class="reset" (click)="resetFilters()" [disabled]="isLoading">
      –°–±—Ä–æ—Å–∏—Ç—å
    </button>
  </div>
</div>

<!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ (–º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç) -->
<div *ngIf="searchResults.length > 0" class="search-results">
  <h3>–ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: {{ searchResults.length }}</h3>
  <div class="results-grid">
    <div *ngFor="let product of searchResults" class="product-card">
      <h4>{{ product.fullName }}</h4>
      <p>–ê—Ä—Ç–∏–∫—É–ª: {{ product.article }}</p>
      <p>–¶–µ–Ω–∞: {{ product.price }} ‚ÇΩ</p>
      <p class="description">{{ product.description | slice:0:100 }}...</p>
      <!-- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π -->
    </div>
  </div>
</div>