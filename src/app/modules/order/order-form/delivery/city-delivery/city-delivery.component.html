<div class="city-delivery-container">
  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
  <div class="delivery-header">
    <h3 class="delivery-title">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
      </svg>
      –î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –≥–æ—Ä–æ–¥—É
    </h3>
    <p class="delivery-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ —Å–ø–æ—Å–æ–±</p>
  </div>

  <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
  <div class="loading-state" *ngIf="loading">
    <div class="loading-spinner"></div>
    <p>–ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∞—à–∏ –∞–¥—Ä–µ—Å–∞...</p>
  </div>

  <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
  <div class="error-state" *ngIf="error && !loading">
    <div class="error-content">
      <div class="error-icon">‚ö†Ô∏è</div>
      <p>{{ error }}</p>
      <button class="retry-btn" (click)="loadAddresses()">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É</button>
    </div>
  </div>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
  <div *ngIf="!loading && !error">
    <!-- –í—ã–±—Ä–∞–Ω–Ω—ã–π –∞–¥—Ä–µ—Å -->
    <div class="selected-address-section" *ngIf="selectedAddress && !showAddressList && !showNewAddressForm">
      <div class="address-card selected">
        <div class="address-header">
          <div class="address-content">
            <h4 class="address-title">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</h4>
            <p class="address-text">{{ getFullAddress(selectedAddress) }}</p>
          </div>
        </div>
        <div class="address-actions">
          <button class="change-btn" (click)="showAddressSelection()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
            </svg>
            –ò–∑–º–µ–Ω–∏—Ç—å –∞–¥—Ä–µ—Å
          </button>
        </div>
      </div>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ -->
    <div class="address-selection" *ngIf="showAddressList">
      <div class="selection-header">
        <h4>–í—ã–±–µ—Ä–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</h4>
        <button class="close-selection" (click)="cancelSelection()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
        </button>
      </div>

      <div class="addresses-list">
        <div 
          *ngFor="let address of addresses"
          class="address-card"
          [class.selected]="selectedAddress?.id === address.id"
          (click)="selectAddress(address)"
        >
          <div class="address-icon">üè†</div>
          <div class="address-content">
            <p class="address-text">{{ getFullAddress(address) }}</p>
          </div>
          <div class="address-check" *ngIf="selectedAddress?.id === address.id">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
            </svg>
          </div>
        </div>
      </div>

      <div class="selection-footer">
        <button class="add-address-btn" (click)="showAddressForm()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
          </svg>
          –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∞–¥—Ä–µ—Å
        </button>
      </div>
    </div>

    <!-- –§–æ—Ä–º–∞ –Ω–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ -->
    <div class="new-address-form" *ngIf="showNewAddressForm">
      <div class="form-header">
        <h4>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∞–¥—Ä–µ—Å</h4>
        <button class="close-form" (click)="cancelSelection()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
        </button>
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label>–ì–æ—Ä–æ–¥ *</label>
          <input 
            type="text" 
            [(ngModel)]="newAddress.city" 
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ—Å–∫–≤–∞"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label>–£–ª–∏—Ü–∞ *</label>
          <input 
            type="text" 
            [(ngModel)]="newAddress.street" 
            placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —É–ª–∏—Ü—ã"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label>–î–æ–º *</label>
          <input 
            type="text" 
            [(ngModel)]="newAddress.house" 
            placeholder="–ù–æ–º–µ—Ä –¥–æ–º–∞"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label>–ö–æ—Ä–ø—É—Å</label>
          <input 
            type="text" 
            [(ngModel)]="newAddress.housing" 
            placeholder="–ö–æ—Ä–ø—É—Å (–µ—Å–ª–∏ –µ—Å—Ç—å)"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label>–ö–≤–∞—Ä—Ç–∏—Ä–∞/–û—Ñ–∏—Å</label>
          <input 
            type="text" 
            [(ngModel)]="newAddress.office" 
            placeholder="–ù–æ–º–µ—Ä –∫–≤–∞—Ä—Ç–∏—Ä—ã –∏–ª–∏ –æ—Ñ–∏—Å–∞"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label>–≠—Ç–∞–∂</label>
          <input 
            type="text" 
            [(ngModel)]="newAddress.floorNumber" 
            placeholder="–≠—Ç–∞–∂"
            class="form-input"
          />
        </div>

        <div class="form-group full-width">
          <label>–ü–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å *</label>
          <input 
            type="text" 
            [(ngModel)]="newAddress.postIndex" 
            placeholder="123456"
            class="form-input"
          />
        </div>

        <div class="form-group full-width">
          <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –∫—É—Ä—å–µ—Ä–∞</label>
          <textarea 
            [(ngModel)]="newAddress.comment" 
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –∫–æ–¥ –¥–æ–º–æ—Ñ–æ–Ω–∞, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–¥—ä–µ–∑–¥–∞ –∏ —Ç.–¥."
            class="form-textarea"
            rows="3"
          ></textarea>
        </div>
      </div>

      <div class="form-actions">
        <button class="cancel-btn" (click)="cancelSelection()">–û—Ç–º–µ–Ω–∞</button>
        <button 
          class="save-btn" 
          (click)="addNewAddress()"
          [disabled]="!newAddress.city || !newAddress.street || !newAddress.house || !newAddress.postIndex"
        >
          –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞–¥—Ä–µ—Å
        </button>
      </div>
    </div>

    <!-- –í—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ -->
    <!-- <div class="delivery-options" *ngIf="hasAddress() && !showAddressList && !showNewAddressForm">
      <div class="options-header">
        <h4>–°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏</h4>
        <p class="options-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—ã–π –¥–ª—è –≤–∞—Å –≤–∞—Ä–∏–∞–Ω—Ç</p>
      </div>

      <div class="options-grid">
        <div 
          *ngFor="let option of deliveryOptions"
          class="option-card"
          [class.selected]="selectedDeliveryOption.id === option.id"
          (click)="selectDeliveryOption(option)"
        >
          <div class="option-icon">{{ option.icon }}</div>
          <div class="option-content">
            <div class="option-title">{{ option.name }}</div>
            <div class="option-details">
              <span class="option-duration">{{ option.duration }}</span>
              <span class="option-price">{{ option.price }} ‚ÇΩ</span>
            </div>
          </div>
          <div class="option-check" *ngIf="selectedDeliveryOption.id === option.id">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
            </svg>
          </div>
        </div>
      </div>
    </div> -->

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ -->
    <div class="delivery-info" *ngIf="hasAddress() && !showAddressList && !showNewAddressForm">
      <div class="info-card">
        <div class="info-header">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
          </svg>
          <h5>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ</h5>
        </div>
        
        <ul class="info-list">
          <li>–î–æ—Å—Ç–∞–≤–∫–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤ —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏ —Å 9:00 –¥–æ 21:00</li>
          <li>–ö—É—Ä—å–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –∑–∞ 30 –º–∏–Ω—É—Ç –¥–æ –¥–æ—Å—Ç–∞–≤–∫–∏</li>
          <li>–û–ø–ª–∞—Ç–∞ –≤–æ–∑–º–æ–∂–Ω–∞ –Ω–∞–ª–∏—á–Ω—ã–º–∏ –∏–ª–∏ –∫–∞—Ä—Ç–æ–π –∫—É—Ä—å–µ—Ä—É</li>
        </ul>
      </div>
    </div>
  </div>
</div>